<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Marketplace Product Landing</title>
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    background: #121212;
    color: #f0f0f0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 1rem;

    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
  }

  button {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;

    outline: none;
    -webkit-tap-highlight-color: transparent;
  }

  button:focus, button:active {
    outline: none;
    box-shadow: none;
  }

  button::-moz-focus-inner {
    border: 0;
  }

  .container {
    background: #1e1e1e;
    border-radius: 16px;
    max-width: 460px;
    width: 100%;
    box-shadow: 0 8px 24px rgb(0 0 0 / 0.8);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  .product-image {
    width: 100%;
    aspect-ratio: 4 / 3;
    object-fit: cover;
    display: block;
    border-bottom: 1px solid #333;
  }
  .content {
    padding: 1.5rem 2rem;
    display: flex;
    flex-direction: column;
    gap: 0.7rem;
  }
  h1 {
    font-weight: 700;
    margin: 0;
    font-size: 1.8rem;
    letter-spacing: 0.05em;
  }
  p.description {
    color: #bbb;
    line-height: 1.4;
    margin: 0;
  }
  .price {
    font-weight: 700;
    font-size: 1.4rem;
    color: #4ade80;
  }
  .reviews {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .stars {
    display: flex;
    gap: 2px;
  }
  .stars svg {
    width: 20px;
    height: 20px;
    fill: #facc15;
    filter: drop-shadow(0 0 1px #b78e04);
  }
  .reviews span {
    color: #999;
    font-size: 0.9rem;
  }
  /* Seller info */
  .seller-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-top: 1rem;
  }
  .seller-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: 2px solid #4ade80;
    object-fit: cover;
  }
  .seller-name {
    font-weight: 600;
    color: #a5f3fc;
    cursor: pointer;
  }
  .seller-status {
    font-size: 0.8rem;
    color: #6ee7b7;
    background: #064e3b;
    padding: 2px 6px;
    border-radius: 8px;
    margin-left: auto;
    user-select: none;
  }
  /* Condition badge */
  .condition-badge {
    display: inline-block;
    font-size: 0.75rem;
    font-weight: 700;
    color: #121212;
    background: #22c55e;
    padding: 4px 10px;
    border-radius: 12px;
    letter-spacing: 0.05em;
    margin-top: 0.25rem;
    width: fit-content;
  }
  /* Location and shipping */
  .location-shipping {
    display: flex;
    gap: 1rem;
    margin-top: 0.8rem;
    color: #8b8b8b;
    font-size: 0.9rem;
  }
  .location-shipping svg {
    width: 18px;
    height: 18px;
    stroke: #8b8b8b;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    fill: none;
    vertical-align: middle;
    margin-right: 4px;
  }
  /* Tags */
  .tags {
    margin-top: 1rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
  }
  .tag {
    background: #333;
    color: #4ade80;
    font-weight: 600;
    font-size: 0.8rem;
    padding: 4px 10px;
    border-radius: 10px;
    user-select: none;
  }
  /* Quick stats */
  .stats {
    margin-top: 1rem;
    display: flex;
    gap: 1.5rem;
    font-size: 0.9rem;
    color: #8b8b8b;
    user-select: none;
  }
  .stats svg {
    width: 18px;
    height: 18px;
    stroke: #8b8b8b;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    fill: none;
    vertical-align: middle;
    margin-right: 6px;
  }
  /* Buttons */
  .buttons {
    display: flex;
    gap: 1rem;
    margin-top: 1.2rem;
  }
  button {
    flex: 1;
    padding: 0.9rem 1.2rem;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 12px;
    cursor: pointer;
    border: none;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 12px rgb(0 0 0 / 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.6rem;
    user-select: none;
  }
  button.buy {
    background: #22c55e;
    color: #121212;
  }
  button.buy:hover {
    background: #16a34a;
    box-shadow: 0 6px 18px #16a34aaa;
  }
  button.trade {
    background: transparent;
    border: 2px solid #4ade80;
    color: #4ade80;
    font-weight: 700;
    letter-spacing: 0.05em;
  }
  button.trade:hover {
    background: #4ade80;
    color: #121212;
    box-shadow: 0 6px 18px #4ade80aa;
  }
  button.trade:active {
    background-color: transparent !important;
    color: #4ade80;
    opacity: 0.7;
    box-shadow: none;
  }
  /* Trade icon style */
  .trade-icon {
    width: 20px;
    height: 20px;
    stroke: #4ade80;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    fill: none;
    filter: drop-shadow(0 0 1px #4ade80cc);
  }
  /* Wishlist heart button */
  .wishlist-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    align-self: flex-start;
    margin-top: 0.8rem;
    padding: 6px;
    border-radius: 50%;
    color: #4ade80;
    transition: color 0.3s ease;
  }
  .wishlist-btn:hover {
    color: #16a34a;
  }
  .wishlist-btn svg {
    width: 24px;
    height: 24px;
    fill: currentColor;
    user-select: none;
  }
  .wishlist-btn:focus {
    outline: none;
  }
  /* Review form */
  #review-form textarea {
    resize: vertical;
    min-height: 80px;
    font-family: inherit;
    font-size: 1rem;
    border-radius: 8px;
    border: 1px solid #444;
    background: #222;
    color: #eee;
    padding: 0.6rem;
    width: 100%;
    box-sizing: border-box;
  }
  #review-form button {
    margin-top: 0.5rem;
    background: #22c55e;
    border: none;
    color: #121212;
    padding: 0.7rem 1.2rem;
    border-radius: 10px;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #review-form button:hover {
    background: #16a34a;
  }
  @media (max-width: 480px) {
    .container {
      max-width: 100%;
    }
    h1 {
      font-size: 1.5rem;
    }
    button {
      font-size: 1rem;
      padding: 0.8rem 1rem;
    }
    .seller-name {
      font-size: 0.9rem;
    }
  }
</style>
</head>
<body>
  <article class="container" role="main">
    <img id="product-image" src="" alt="Product Image" class="product-image" />

    <div class="content">
      <h1 id="product-title"></h1>

      <div class="reviews" id="product-reviews" aria-label="Product reviews">
        <div class="stars" aria-hidden="true" id="star-container"></div>
        <span id="review-count"></span>
      </div>

      <p class="price" id="product-price"></p>
      <p class="description" id="product-description"></p>

      <div class="seller-info">
        <img id="seller-avatar" src="" alt="Seller Avatar" class="seller-avatar" />
        <div class="seller-name" id="seller-name"></div>
        <div class="seller-status" id="seller-status" title=""></div>
      <div class="location-shipping">
        <div class="location" aria-label="Location">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 21c-4 0-7-5-7-8a7 7 0 0114 0c0 3-3 8-7 8z" />
            <circle cx="12" cy="10" r="2" />
          </svg>
          <span id="product-location"></span>
        </div>
        <div class="shipping" aria-label="Shipping info">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 3h18v12H3z" />
            <path d="M7 15v2h10v-2" />
          </svg>
          <span id="shipping-info"></span>
        </div>
      </div>

      <span class="condition-badge" id="product-condition"></span>

      <div class="tags" id="product-tags" aria-label="Product tags"></div>

      <div class="stats" aria-label="Product statistics">
        <div class="views" title="Views">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
            <circle cx="12" cy="12" r="3" />
          </svg>
          <span id="view-count"></span>
        </div>
        <div class="favorites" title="Favorites">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 21l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4A4.5 4.5 0 0112 7.5 4.5 4.5 0 0117.5 4C20 4 22 6 22 8.5c0 3.78-3.4 6.86-8.55 11.18L12 21z" />
          </svg>
          <span id="favorite-count"></span>
        </div>
      </div>

      <button id="wishlist-btn" class="wishlist-btn" aria-pressed="false" aria-label="Add to favorites">
        <svg viewBox="0 0 24 24" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" stroke-linecap="round">
          <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"></path>
        </svg>
      </button>

      <div class="buttons">
        <button id="buy-btn" class="buy" aria-label="Buy this product">
          Buy Now
        </button>
        <button id="trade-btn" class="trade" aria-label="Trade for this product">
          <svg class="trade-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M4 17v-3a4 4 0 014-4h9" />
            <polyline points="19 10 22 7 19 4" />
            <path d="M20 7H9a4 4 0 00-4 4v3" />
            <polyline points="5 14 2 17 5 20" />
          </svg>
          Trade
        </button>
      </div>

      <!-- Review Form -->
      <form id="review-form" aria-label="Submit a review">
        <label for="review-text" class="sr-only">Write a review</label>
        <textarea id="review-text" name="review" placeholder="Write your review here..." required></textarea>
        <button type="submit">Submit Review</button>
      </form>
    </div>
  </article>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-analytics.js";
  import { getFirestore, doc, getDoc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
    authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
    databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
    projectId: "itzhoyoo-f9f7e",
    storageBucket: "itzhoyoo-f9f7e.firebasestorage.app",
    messagingSenderId: "1094792075584",
    appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
    measurementId: "G-LLT6F9WRKH"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const db = getFirestore(app);
  const auth = getAuth(app);

  // Get productId from URL query ?productId=...
  const params = new URLSearchParams(window.location.search);
  const productId = params.get('productId');

  async function loadProduct() {
    if (!productId) {
      alert('No product ID specified.');
      return;
    }
    const productRef = doc(db, "products", productId);
    const productSnap = await getDoc(productRef);
    if (productSnap.exists()) {
      const data = productSnap.data();
      document.getElementById('product-title').textContent = data.title;
      document.getElementById('product-description').textContent = data.description;
      document.getElementById('product-price').textContent = `$${data.price.toFixed(2)}`;
      document.getElementById('product-image').src = data.image;
      document.getElementById('seller-name').textContent = data.sellerName;
      document.getElementById('seller-avatar').src = data.sellerAvatar || '';
      document.getElementById('seller-status').textContent = data.sellerStatus || '';
      document.getElementById('product-condition').textContent = data.condition || '';
      // Add tags
      const tagsContainer = document.getElementById('product-tags');
      tagsContainer.innerHTML = '';
      if (data.tags && data.tags.length) {
        data.tags.forEach(tag => {
          const tagEl = document.createElement('span');
          tagEl.className = 'tag';
          tagEl.textContent = tag;
          tagsContainer.appendChild(tagEl);
        });
      }
      // Location & shipping
      document.querySelector('#product-location span').textContent = data.location || '';
      document.querySelector('#product-location').title = data.location || '';
      document.querySelector('#product-shipping span').textContent = data.shipping || '';
      document.querySelector('#product-shipping').title = data.shipping || '';
      // Stats
      document.querySelector('#product-trades span').textContent = data.trades || 0;
      document.querySelector('#product-sold span').textContent = data.sold || 0;
    } else {
      alert('Product not found.');
    }
  }

  // Wishlist (favorite) button
  document.querySelector('.wishlist-btn').addEventListener('click', async () => {
    const user = auth.currentUser;
    if (!user) {
      alert('Please log in to save favorites.');
      return;
    }
    const userRef = doc(db, 'users', user.uid);
    await updateDoc(userRef, {
      favorites: arrayUnion(productId)
    });
    alert('Added to favorites!');
  });

  // Buy & Trade button handlers
  document.querySelector('.buy').addEventListener('click', () => {
    alert(`Buying Product ID: ${productId}`);
    // Add your purchase logic here
  });

  document.querySelector('.trade').addEventListener('click', () => {
    alert(`Offering trade for Product ID: ${productId}`);
    // Add your trade logic here
  });

  // Auth state listener
  onAuthStateChanged(auth, user => {
    if (user) {
      console.log('User logged in:', user.email);
      // You can update UI accordingly
    } else {
      console.log('No user logged in');
    }
  });

  // Load product data on page load
  loadProduct();
</script>
</body>
</html>